(;; Turns an 8-byte value into a literal-expression representation of it.)

(function value->literal (binary r)
	[lst [lllllllst -l- -i- -t- -e- -r- -a- -l- emt r]
		[lst (with return {(continuation write (count in out)
				(if count
					{write [- count (literal 0000000000000000000000000000000000000000000000000000000000000001)]
						[>> in (literal 0000000000000000000000000000000000000000000000000000000000000001)]
						[lst (if [land in (literal 0000000000000000000000000000000000000000000000000000000000000001)]
							-1- -0-) out r]}
					{return out}))
				(literal 0000000000000000000000000000000000000000000000000000000001000000) binary emt})
			emt r]r])

(;; Turns the base-10 fragment input into a literal expression.)

(function # (l r) [value->literal
	(with return {(continuation read (in out)
		(if [emt? in]
			{return out}
			{read [@rst in] [+ [* out (literal 0000000000000000000000000000000000000000000000000000000000001010)]
				(if [char= [@fst in] -9-] (literal 0000000000000000000000000000000000000000000000000000000000001001)
				(if [char= [@fst in] -8-] (literal 0000000000000000000000000000000000000000000000000000000000001000)
				(if [char= [@fst in] -7-] (literal 0000000000000000000000000000000000000000000000000000000000000111)
				(if [char= [@fst in] -6-] (literal 0000000000000000000000000000000000000000000000000000000000000110)
				(if [char= [@fst in] -5-] (literal 0000000000000000000000000000000000000000000000000000000000000101)
				(if [char= [@fst in] -4-] (literal 0000000000000000000000000000000000000000000000000000000000000100)
				(if [char= [@fst in] -3-] (literal 0000000000000000000000000000000000000000000000000000000000000011)
				(if [char= [@fst in] -2-] (literal 0000000000000000000000000000000000000000000000000000000000000010)
				(if [char= [@fst in] -1-] (literal 0000000000000000000000000000000000000000000000000000000000000001)
					(literal 0000000000000000000000000000000000000000000000000000000000000000))))))))))]}))
		[@fst l] (literal 0000000000000000000000000000000000000000000000000000000000000000)}) r])
